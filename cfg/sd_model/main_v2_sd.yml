seed: 0
device: cuda:0
path:
  name: main_v2
  base_dir: experiments/kitti_sd/
  log: log
  results: results
  checkpoint: checkpoint
  resume: null
  pretrain: &pretrained_model experiments/kitti_sd/main_v2/checkpoint/best_model.pth
  
model:
  surrogate:
    type: ProjFusionNet  # Chosen from ['ProjFusionNet','LCCNet','CalibNet','RGGNet','LCCRAFT'], argv should match relative class as well
    argv:
      activation: leakyrelu
      inplace: true
      encoder_argv:
        resnet_depth: 18
        resnet_pretrained: true
        resnet_frozen: true
        pointgpt_config: cfg/pointgpt/finetune_kitti_tiny.yaml
        pointgpt_checkpoint: pretrained/kitti_pointgpt_s/ckpt-last.pth
        pointgpt_frozen: true
        max_depth: 50.0
        proj_planes: 32
        fusion_knn: 4
      aggregation_argv:
        planes: 96
        final_feat: [2, 4]
        rot_mlp_dims: [256, 128]
        tsl_mlp_dims: [256, 128]
      proj_features: true
      depth_features: true

  diffusion_scheduler:
    train:
      schedule_type: cosine
      n_diff_steps: 200
      beta_1: 1.0E-4
      beta_T: 0.05
      sigma_r: 0.05
      sigma_t: 0.03
      add_noise: true
    val:
      schedule_type: cosine
      n_diff_steps: 10
      beta_1: 0.2
      beta_T: 0.8
      sigma_r: 0.1
      sigma_t: 0.01
      add_noise: true
loss:
  type: mae
  args:
    reduction: mean

optimizer:
  type: prodigy 
  args:
    betas: [0.9, 0.999]
    weight_decay: 1.0E-2
    decouple: true
  max_grad: 1.0

scheduler:
  type: cosine
  args:
    T_max: &n_epoch 30

run:
  n_epoch: *n_epoch
  val_per_epoch: 5
  log_per_iter: 16