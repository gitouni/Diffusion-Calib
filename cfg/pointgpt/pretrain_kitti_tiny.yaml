npoints: &npoints 8196
max_depth: &max_depth 50.0
total_bs: 96
step_per_update: 1
max_epoch: &max_epoch 50

optimizer: { type: AdamW, kwargs: { lr: 0.0001, weight_decay: 0.01 } }

scheduler: { type: CosLR, kwargs: { epochs: *max_epoch, initial_epochs: 100 } }

dataset:
  {
    train:
      {
        _base_: cfg/pointgpt/KITTI.yaml,
        others: { subset: "train", SEQS: ['00','02','03','04','05','06','07','08','10','12'], MAX_DEPTH: *max_depth, npoints: *npoints},
      },
    val:
      {
        _base_: cfg/pointgpt/KITTI.yaml,
        others: { subset: "test", SEQS: ['16','17','18'], MAX_DEPTH: *max_depth, npoints: *npoints},
      },
    test:
      {
        _base_: cfg/pointgpt/KITTI.yaml,
        others: { subset: "test", SEQS: ['13','14','15','20','21'], MAX_DEPTH: *max_depth, npoints: *npoints},
      },
  }

model:
  {
    NAME: PointGPT,
    cls_dim: 40,
    group_size: 32,
    num_group: 128,
    loss: cdl12,
    weight_center: 1,
    transformer_config:
      {
        mask_ratio: 0.7,
        mask_type: "rand",
        trans_dim: 384,
        encoder_dims: 384,
        depth: 6,
        drop_path_rate: 0.1,
        num_heads: 6,
        decoder_depth: 4,
        decoder_num_heads: 6,
      },
  }


